!function(n,c){n.jxtrkr||(n.jxtrkr={postApiUrl:"https://tr.jixie.io/sync/{env}",delay:1,accountid:"",interval:null,user:{email:"unknown"},env:"prod",client_id:"",payload:{},init:function(){if(this.init=!1,!this.init){this.client_id="",this.sid="",n.jixie_o&&!isNaN(n.jixie_o.delay)&&(this.delay=n.jixie_o.delay);var e=this.read(!0);e.id?(n.jxtrkr.client_id=e.id,e.sid?n.jxtrkr.sid=e.sid:(n.jxtrkr.sid=parseInt(Date.now()/1e3)+"-"+e.id,n.jxtrkr.write(n.jxtrkr.client_id,n.jxtrkr.sid,!0)),setTimeout(function(){n.jxtrkr.interval=setInterval(n.jxtrkr.push.bind(n.jxtrkr),1e3)},100*n.jxtrkr.delay)):this.ajax({type:"GET",url:this.postApiUrl.replace("{env}","load"),success:function(e){try{(e=JSON.parse(e)).client_id&&(n.jxtrkr.client_id=e.client_id,n.jxtrkr.sid=e.sid,n.jxtrkr.write(n.jxtrkr.client_id,n.jxtrkr.sid,!0),setTimeout(function(){n.jxtrkr.interval=setInterval(n.jxtrkr.push.bind(n.jxtrkr),1e3)},100*n.jxtrkr.delay))}catch(e){return}},error:function(e){}}),this.init=!0}},getQueryStringValue:function(e,t){return e?decodeURIComponent(e.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(t).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")):null},sendData:function(e,t,i){var r={accountid:e.accountid,referer:e.referer,action:e.action};e.email&&(r.email=e.email),e.parameters&&(r.payload=e.parameters),e.device&&(r.device=e.device),e.clientid&&(r.client_id=e.clientid),e.sid&&(r.sid=e.sid),this.ajax({type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",url:this.postApiUrl.replace("{env}",this.env),data:JSON.stringify(r),success:t,error:i})},ajax:function(t){var i;(i=n.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open(t.type,t.url,!0),i.withCredentials=!0,t.contentType&&i.setRequestHeader("Content-Type",t.contentType),i.crossDomain=!0,i.withCredentials=!0,i.onreadystatechange=function(){if(4==i.readyState){i.getAllResponseHeaders();200==i.status?t.success(i.response):t.error(i.status,i.response)}},i.onerror=function(e){0===i.status&&t.error(e)},i.send("POST"===t.type?t.data:null)},write:function(e,t,i){if(i){this.writeC(e,t);try{n.localStorage.setItem("_jx",e)}catch(e){}}},writeC:function(e,t){var i=n.location.hostname.match(/[^.]*\.[^.]{2,3}(?:\.[^.]{2,3})?$/gm);if(e){var r="_jx="+e+";"+("expires="+new Date((new Date).setFullYear((new Date).getFullYear()+1)).toUTCString())+";";c.cookie=r+"path=/",i&&(c.cookie=r+"domain=."+i+";path=/")}if(t){var a="_jxs="+t+";"+s+";",s="expires="+new Date((new Date).setMinutes((new Date).getMinutes()+30));c.cookie=a+"path=/",i&&(c.cookie=a+"domain=."+i+";path=/")}},readC:function(){var e={};if(document.cookie&&""!=document.cookie)for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var r=t[i].split("=");r[0]=r[0].replace(/^ /,""),e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e},read:function(e){if(e){var t=this.readC();t.id=t._jx,t.sid=t._jxs;var i=null;try{t.id&&""!=t.id||(i=n.localStorage,t.id=i.getItem("_jx"))}catch(e){}var r=this.getQueryStringValue(c.location.href,"sid");return r&&(t.sid=r),{id:t.id,sid:t.sid}}return{id:"00000000-0000-0000-0000-000000000000",sid:"000000000-00000000-0000-0000-0000-000000000000"}},push:function(){var e=(new Date).getTime(),t=!1;n.jixie_o&&!isNaN(n.jixie_o.delay)&&(this.delay=n.jixie_o.delay),n.jixie_o&&!isNaN(n.jixie_o.lastcall)&&(3e3<e-n.jixie_o.lastcall?n.jixie_o.lastcall=e:t=!0);var i=n.jixie_p;if(i&&Array.isArray(i)&&0<i.length&&!t){n.jixie_o?isNaN(n.jixie_o.lastcall)&&(n.jixie_o.lastcall=e):n.jixie_o={lastcall:e};var r=i.shift();this.postApiUrl=r.postApiUrl||this.postApiUrl;var a={accountid:r.accountid,clientid:n.jxtrkr.client_id,sid:n.jxtrkr.sid,parameters:{},referer:c.location.href,email:r.email?this.user.email=r.email:this.user.email,action:r.action?r.action=r.action.toLowerCase():""};switch(a.action){case"viewhome":break;case"viewsection":a.parameters={category:r.category||""};break;case"viewitem":a.parameters={itemid:r.parameters.itemid||"",price:r.parameters.price||0,availability:r.parameters.availability||"",currency:r.parameters.currency||""};break;case"viewlist":a.parameters={items:r.parameters.items||[],category:r.parameters.category||"",page:r.parameters.page||1};break;case"viewsearch":a.parameters={items:r.parameters.items||[],keywords:r.parameters.keywords||[],page:r.parameters.page||1};break;case"viewcart":a.parameters={items:r.parameters.items&&Array.isArray(r.parameters.items)?r.parameters.items.map(function(e){return{itemid:e.itemid||"",price:e.price||0,quantity:e.quantity||1,currency:e.currency||""}}):[]};break;case"addcart":a.parameters={itemid:r.parameters.itemid||"",price:r.parameters.price||0,quantity:r.parameters.quantity||1,currency:r.parameters.currency||""};break;case"purchase":a.parameters={items:r.parameters.items&&Array.isArray(r.parameters.items)?r.parameters.items.map(function(e){return{itemid:e.itemid||"",price:e.price||0,quantity:e.quantity||1,currency:e.currency||""}}):[],transactionid:r.parameters.transactionid||""};break;default:a.parameters=r.parameters}this.sendData(a,function(e){},function(e){})}}},/comp|inter|loaded/.test(c.readyState)?n.jxtrkr.init():c.addEventListener("DOMContentLoaded",n.jxtrkr.init.bind(n.jxtrkr)))}(window,document);